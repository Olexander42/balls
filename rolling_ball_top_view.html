<!DOCTYPE html>
<html>
  <head>
    <title>Rolling Ball</title>
  </head>
  <body>
    <canvas width="1900" height="500" style="border: solid 1px gray"></canvas>
    <script>
      const canvas = document.querySelector("canvas");
      const ctx = canvas.getContext("2d");

      const ms = 17; // 17ms = 60fps 
      const frictionLoss = 0.2 / (1000 / ms); // ball should lose 20% velocity per second


      class Ball {
        constructor() {
          this.r = 50;
          this.x = getRandomInt(this.r, canvas.width - this.r); 
          this.y = getRandomInt(this.r, canvas.height - this.r);  
          this.xSpeed = this.ySpeed = getRandomInt(-100, 100);
        }

        draw() {
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
          ctx.fill(); 
        };   

        move() {
          if (Math.abs(this.xSpeed) < 0.1 || Math.abs(this.ySpeed) < 0.1) clearInterval(intervalId); // the friction stops the ball abruptly

          ctx.clearRect(0, 0, canvas.width, canvas.height);

          this.xSpeed *= (1 - frictionLoss);
          this.ySpeed *= (1 - frictionLoss);

          this.x += this.xSpeed;
          this.y += this.ySpeed; 

          if ((this.x > canvas.width - this.r && this.xSpeed > 0) || // right border
            (this.x < this.r  && this.xSpeed < 0)) { // left border
            this.xSpeed *= -0.5;
          }

          if ((this.y > canvas.height - this.r && this.ySpeed > 0) || // bottom border
              (this.y < this.r && this.ySpeed < 0)) { // top border
              this.ySpeed *= -0.5;
          } 
          this.draw();
        };
      };

      function choice(array) { // randomly choose an element out of any array
        return array[Math.floor(Math.random() * (array.length))];
      }

      function getRandomInt(min, max) { // randomly pick a value from the range (except 0)
        while (true) {
          let result = Math.floor(Math.random() * ((max - min) +1) + min);
          if (result !== 0) return result;
        }
      };
         


      let ball = new Ball();

      const intervalId = setInterval( () => {
        ball.move();
      }, ms);
      
    </script>
  </body>
</html>